{{ header }}

<div class="container-fluid container-lg flex-grow-1 sc-product mobile-no-gutters">
    <nav aria-label="breadcrumb">
        <ul class="breadcrumb sc-breadcrumb fsz-12">
            {% for breadcrumb in breadcrumbs %}
                {% if loop.last %}
                    <li class="breadcrumb-item sc-breadcrumb-item">{{ breadcrumb.text }}</li>
                {% else %}
                    <li class="breadcrumb-item sc-breadcrumb-item">
                        <a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a>
                    </li>
                {% endif %}
            {% endfor %}
        </ul>
    </nav>
    <main class="main">
        {{ content_top }}
        {% if error_warning %}
            <div class="alert alert-danger d-none">
                <i class="fa fa-exclamation-circle"></i>
                {{ error_warning }}
                <button type="button" class="close" data-dismiss="alert">&times;</button>
            </div>
            <script>
                $(function () {
                    $('#button-go').attr('disabled', 'disabled');
                    $('#button-go').addClass('disabled');
                });
            </script>
        {% endif %}
        <div class="row">
            <div class="col-12 sc-page-title pb-3">
                <h1>{{ heading_title }}</h1>
            </div>
        </div>
        <div class="oct-checkout row g-3 g-md-4">
            <div class="col-lg-8 left-side-checkout">
                <div class="row">
                    <div class="col-12 wrapper_checkout_mono mb-15">
                        <div class="row d-flex justify-content-center">
                            <div class="col-md-6 col-sm-7 col-10">
                                <button id="mono_checkout_cart_page"
                                        class="mono_checkout__button mono_checkout__button--black">
                                    <span>Оформити через</span> <img
                                            src="catalog/view/theme/default/image/mono_checkout/monocheckout_logo_white.svg"
                                            alt="button_logo"></button>
                            </div>
                        </div>
                        <div class="divider">
                            <span>Або</span>
                        </div>
                    </div>
                </div>
                <div class="d-flex flex-column">
                    <div class="row mb-4 order-{{ delivery_block_sort }}">
                        <div class="col-12 order-1 order-lg-0">
                            <div class="oct-checkout-block h-100 shipping-method">
                                <div class="oct-checkout-block-title d-flex align-items-center mb-4">
                                    <img src="catalog/view/theme/oct_showcase/img/sprite-fastorder.svg#include--delivery-icon"
                                         alt="" width="24" height="24">
                                    <span class="text-uppercase- ps-3">{{ heading_shipping_block }}</span>
                                </div>
                                {% if error_warning %}
                                    <div class="alert alert-warning fsz-14">
                                        <i class="fa fa-exclamation-circle"></i>
                                        {{ error_warning }}</div>
                                {% endif %}
                                {% if shipping_methods %}
{#                                    <p class="mb-3">{{ text_shipping_method }}</p>#}
                                    <div class="shipping-method-box">
                                        {% for shipping_method in shipping_methods %}
{#                                            <p class="mb-2">#}
{#                                                <strong>{{ shipping_method.title }}</strong>#}
{#                                            </p>#}
                                            {% if not shipping_method.error %}
                                                {% for quote in shipping_method['quote'] %}
                                                    <div class="form-check d-flex align-items-center  {% if quote.code == 'pickup.pickup' %} mb-0 {% endif %}">
                                                        <label class="form-check-label d-flex align-items-center">
                                                            {% if quote.code == code or  not code %}
                                                                {% set code = quote.code %}
                                                                <input type="radio" class="form-check-input"
                                                                       name="shipping_method" value="{{ quote.code }}"
                                                                       title="{{ quote.title }}" checked="checked"/>
                                                            {% else %}
                                                                <input type="radio" class="form-check-input"
                                                                       name="shipping_method" value="{{ quote.code }}"
                                                                       title="{{ quote.title }}"/>
                                                            {% endif %}
                                                            {{ quote.title }}
                                                            {% if show_cost_in_delivery_block is defined and show_cost_in_delivery_block %} - {{ quote.text }}{% endif %}
                                                        </label>

                                                        {% if quote.code == 'pickup.pickup' %}
                                                            <div class="delivery-price-block text-uppercase" data-code="{{ quote.code }}">{{ delivery_free }}</div>
                                                        {% else %}
                                                            <div class="delivery-price-block text-uppercase" data-code="{{ quote.code }}">{{ delivery_free }}{#{ delivery_carrier_tariffs }#}</div>
                                                        {% endif %}
                                                    </div>

                                                    {% if quote.code == 'pickup.pickup' %}
                                                        <div class="delivery-description fsz-14">

                                                            <svg width="16" height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                <path d="M8 0.5C12.1349 0.5 15.5 3.86514 15.5 8V8.00195C15.5136 11.0262 13.6245 13.9059 11.6416 16.0781C10.6596 17.1539 9.675 18.0342 8.93555 18.6455C8.56625 18.9508 8.25883 19.1882 8.04492 19.3486C8.0293 19.3604 8.01364 19.3709 7.99902 19.3818C7.3583 18.9115 5.78812 17.6992 4.24609 15.998C2.36568 13.9234 0.600152 11.2045 0.503906 8.28125L0.5 7.99707V7.99512C0.5 3.86549 3.86498 0.500044 8 0.5ZM8 3.5C5.51389 3.50004 3.5 5.51388 3.5 8C3.5 10.4861 5.51389 12.5 8 12.5C10.4861 12.5 12.5 10.4861 12.5 8C12.5 5.51386 10.4861 3.5 8 3.5Z" fill="#001F3F" stroke="#001F3F"/>
                                                            </svg>
                                                            {{ oct_showcase_data.contact_address[oct_lang_id] }}
                                                        </div>
                                                    {% endif %}

                                                {% endfor %}
                                            {% else %}
                                                <div class="alert alert-danger fsz-14">{{ shipping_method.error }}</div>
                                            {% endif %}
                                        {% endfor %}
                                    </div>

                                {% endif %}
                            </div>
                        </div>

                    </div>
                    <div class="row mb-4 order-{{ user_block_sort }}">
                        <div class="col-12">
                            <div class="oct-checkout-block">
                                <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-md-between">
                                    <div class="oct-checkout-block-title d-flex align-items-center mb-4 mb-md-0">
                                        <img src="catalog/view/theme/oct_showcase/img/sprite-fastorder.svg#include--user-icon"
                                             alt="" width="24" height="24">
                                        <span class="text-uppercase-">{{ heading_user_block }}</span>
                                    </div>

                                    {% if not user_logged %}
                                        <a class="socauth-separator-link socauth-separator-link-checkout"  href="/sna-gmail?first=account">
                                            <img src="/image/icons/google.png" alt="{{ text_auth_with_goole }}">
                                                                                        
                                            {{ text_auth_with_goole }}
                                        </a>
                                        <a onclick="octPopupLogin();" class="blue-link">{{ heading_login_block }}</a>
                                    {% endif %}
                                </div>
                                <div class="row mt-3 gx-3 gx-md-4 gy-3 register_block">
                                    {% if oct_fastorder_data.customer_groups == 1 and customer_groups and not user_logged and oct_fastorder_data.registration == 1 %}
                                        <div class="col-lg-12 mb-3">
                                            <label class="dark-text fsz-14 fw-500 mb-1">{{ entry_customer_group }}</label>
                                            {% for customer_group in customer_groups %}
                                                <div class="form-check d-flex align-items-center mb-0">
                                                    <label class="form-check-label d-flex align-items-center ms-0 mb-2">
                                                        <input type="radio" class="form-check-input"
                                                               name="customer_group_id"
                                                               value="{{ customer_group.customer_group_id }}" {% if customer_group.customer_group_id == customer_group_id %} checked="checked" {% endif %}/>{{ customer_group.name }}
                                                    </label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    {% else %}
                                        <input type="hidden" name="customer_group_id" value="{{ customer_group_id }}"/>
                                    {% endif %}
                                    <div class="form-group col-lg-6">
                                        <label class="color-gray fsz-14 fw-500 mb-1" for="input-payment-firstname">
                                            <span class="required">*</span>
                                            {{ entry_firstname }}</label>
                                        <input type="text" name="firstname"
                                               value="{{ address.firstname ? address.firstname : firstname }}"
                                               placeholder="{{ placeholder_firstname }}" id="input-payment-firstname"
                                               class="form-control" inputmode="text">
                                    </div>
                                    {% if oct_fastorder_data.lastname and oct_fastorder_data.lastname == 1 %}
                                        <div class="form-group col-lg-6">
                                            <label class="color-gray fsz-14 fw-500 mb-1" for="input-payment-lastname">
                                                <span class="required">*</span>
                                                {{ entry_lastname }}</label>
                                            <input type="text" name="lastname"
                                                   value="{{ address.lastname ? address.lastname : lastname }}"
                                                   placeholder="{{ placeholder_lastname }}" id="input-payment-lastname"
                                                   class="form-control" inputmode="text">
                                        </div>
                                    {% else %}
                                        <input type="hidden" name="lastname" value=""/>
                                    {% endif %}

                                    {% if oct_fastorder_data.email and oct_fastorder_data.email == 2 %}
                                        <div class="form-group col-lg-6">
                                            <label class="color-gray fsz-14 fw-500 mb-1" for="input-payment-email">
                                                <span class="required">*</span>
                                                {{ entry_email }}</label>
                                            <input type="text" name="email"
                                                   value="{{ email_user ? email_user : email }}"
                                                   placeholder="{{ placeholder_email }}" id="input-payment-email"
                                                   class="form-control" inputmode="email">
                                        </div>
                                    {% elseif oct_fastorder_data.email and oct_fastorder_data.email == 1 %}
                                        <div class="form-group col-lg-6">
                                            <label class="color-gray fsz-14 fw-500 mb-1"
                                                   for="input-payment-email">{{ entry_email }}</label>
                                            <input type="text" name="email"
                                                   value="{{ email_user ? email_user : email }}"
                                                   placeholder="{{ placeholder_email }}" id="input-payment-email"
                                                   class="form-control" inputmode="email">
                                        </div>
                                    {% else %}
                                        <input type="hidden" name="email"
                                               value="{{ oct_fastorder_data.notify_email }}"/>
                                    {% endif %}

                                    <div class="form-group col-lg-6">
                                        <label class="color-gray fsz-14 fw-500 mb-1" for="input-payment-telephone">
                                            <span class="required">*</span>
                                            {{ entry_telephone }}</label>
                                        <input type="tel" name="telephone"
                                               value="{{ telephone_user ? telephone_user : telephone }}"
                                               placeholder="{{ placeholder_phone }}" id="input-payment-telephone"
                                               class="form-control" inputmode="tel">
                                    </div>


                                    {% if not customer_id and oct_fastorder_data.email and oct_fastorder_data.email and not approve %}
                                        <div class="form-group col-lg-12 mb-0" {% if oct_fastorder_data.registration != 1 %} style="display: none;" {% endif %}>
                                            <div class="form-check mb-0 d-flex align-items-center">
                                                <input class="form-check-input" type="checkbox" name="register"
                                                       onclick="$('.register-form').toggle()" id="registerCheckbox">
                                                <label class="form-check-label d-flex align-items-center fsz-14"
                                                       for="registerCheckbox">{{ text_register }}</label>
                                            </div>
                                        </div>
                                    {% endif %}
                                    <div class="form-group col-md-6 register-form" style="display: none;">
                                        <label class="dark-text fsz-14 fw-500 mb-1" for="input-payment-password">
                                            <span class="required">*</span>
                                            {{ entry_password }}</label>
                                        <input type="password" name="password" value=""
                                               placeholder="{{ entry_password }}" id="input-payment-password"
                                               class="form-control"/>
                                    </div>
                                    <div class="form-group col-md-6 register-form" style="display: none;">
                                        <label class="dark-text fsz-14 fw-500 mb-1" for="input-payment-confirm">
                                            <span class="required">*</span>
                                            {{ entry_confirm }}</label>
                                        <input type="password" name="confirm" value="" placeholder="{{ entry_confirm }}"
                                               id="input-payment-confirm" class="form-control"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-4 order-3">
                        <div class="col-12">
                            <div class="oct-checkout-block user_info_adress" data-delivery-code="{{ code }}">
                                <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-md-between">
                                    <div class="oct-checkout-block-title d-flex align-items-center mb-4 mb-md-0">
                                        <img src="catalog/view/theme/oct_showcase/img/sprite-fastorder.svg#include--delivery-icon"
                                             alt="" width="24" height="24">
                                        <span class="text-uppercase-">{{ text_shipping_address }} <span class="p-0 delivery-method-name"></span></span>
                                    </div>
                                </div>
                                <div class="row mt-3 gx-3 gx-md-4 gy-3 register_block">
                                    {% if oct_fastorder_data.customer_groups == 1 and customer_groups and not user_logged and oct_fastorder_data.registration == 1 %}
                                        <div class="col-lg-12 mb-3">
                                            <label class="dark-text fsz-14 fw-500 mb-1">{{ entry_customer_group }}</label>
                                            {% for customer_group in customer_groups %}
                                                <div class="form-check d-flex align-items-center mb-0">
                                                    <label class="form-check-label d-flex align-items-center ms-0 mb-2">
                                                        <input type="radio" class="form-check-input"
                                                               name="customer_group_id"
                                                               value="{{ customer_group.customer_group_id }}" {% if customer_group.customer_group_id == customer_group_id %} checked="checked" {% endif %}/>{{ customer_group.name }}
                                                    </label>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    {% else %}
                                        <input type="hidden" name="customer_group_id" value="{{ customer_group_id }}"/>
                                    {% endif %}


                                    {% if oct_fastorder_data.fax and oct_fastorder_data.fax == 1 %}
                                        <div class="form-group col-lg-6">
                                            <label class="dark-text fsz-14 fw-500 mb-1"
                                                   for="input-payment-fax">{{ entry_fax }}</label>
                                            <input type="text" name="fax"
                                                   value="{% if fax is defined and fax %}{{ fax }}{% endif %}"
                                                   placeholder="{{ entry_fax }}" id="input-payment-fax"
                                                   class="form-control"/>
                                        </div>
                                    {% else %}
                                        <input type="hidden" name="fax" value=""/>
                                    {% endif %}


                                    {% if addresses %}
                                        {% if customer_id %}
                                            <div class="col-md-12{% if not show_payment_adres %} d-none{% endif %}">
                                                <div class="form-check d-flex align-items-center mb-0">
                                                    <label class="form-check-label ms-0 ps-0 mb-3 d-flex align-items-center">
                                                        <input type="radio" class="form-check-input"
                                                               name="payment_address" value="existing" checked="checked"
                                                               onclick="$('#payment-address-new').hide()"/>{{ text_address_existing_payment }}
                                                    </label>
                                                </div>
                                                <div id="payment-existing">
                                                    <select name="payment_address_id" class="form-control rm-select">
                                                        {% for address in addresses %}
                                                            {% if payment_address_id and address.address_id == payment_address_id %}
                                                                <option value="{{ address.address_id }}"
                                                                        selected="selected">
                                                                    {{ address.firstname }}{{ address.lastname }},
                                                                    {{ address.address_1 }},
                                                                    {{ address.city }},
                                                                    {{ address.zone }},
                                                                    {{ address.country }}</option>
                                                            {% else %}
                                                                <option value="{{ address.address_id }}">
                                                                    {{ address.firstname }}{{ address.lastname }},
                                                                    {{ address.address_1 }},
                                                                    {{ address.city }},
                                                                    {{ address.zone }},
                                                                    {{ address.country }}</option>
                                                            {% endif %}
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                            </div>
                                        {% endif %}
                                    {% endif %}

                                    {% if oct_fastorder_data.company == 1 %}
                                        <div class="form-group col-lg-6" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                            <label class="dark-text fsz-14 fw-500 mb-1"
                                                   for="input-payment-company">{{ entry_company }}</label>
                                            <input type="text" name="company"
                                                   value="{% if company is defined and company %}{{ company }}{% endif %}"
                                                   placeholder="{{ entry_company }}" id="input-payment-company"
                                                   class="form-control" inputmode="text">
                                        </div>
                                    {% else %}
                                        <input type="hidden" name="company" value=""/>
                                    {% endif %}
                                    <input type="hidden" name="company_id" value=""/>
                                    <input type="hidden" name="tax_id" value=""/>
                                    {% if oct_fastorder_data.country_and_region == 1 or oct_fastorder_data.country_and_region == 2 %}
                                        <div class="form-group  col-lg-6" {% if (customer_id and addresses) or not show_country %} style="display:none" {% endif %}>
                                            <label class="dark-text fsz-14 fw-500 mb-1"
                                                   for="input-payment-country"><span
                                                        class="required">*</span>{{ entry_country }}</label>
                                            <select name="country_id" id="input-payment-country"
                                                    class="form-control rm-select">
                                                <option value="">{{ text_select }}</option>
                                                {% for country in countries %}
                                                    {% if country.country_id == country_id %}
                                                        <option value="{{ country.country_id }}"
                                                                selected="selected">{{ country.name }}
                                                        </option>
                                                    {% else %}
                                                        <option value="{{ country.country_id }}">{{ country.name }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="input-wrapper-zone_id form-group col-lg-6" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                            <label class="dark-text fsz-14 fw-500 mb-1" for="input-payment-zone">
                                                <span class="required">*</span>
                                                {{ entry_zone }}</label>
                                            <select name="zone_id" id="input-payment-zone"
                                                    class="form-control rm-select"></select>
                                        </div>
                                    {% else %}
                                        <select name="country_id" style="display: none;">
                                            <option value="{{ oct_fastorder_data.default_country }}"
                                                    selected="selected"></option>
                                        </select>
                                        <select name="zone_id" style="display: none;"></select>
                                    {% endif %}

                                    {% if 1 %}
                                        {% if oct_fastorder_data.city == 1 or oct_fastorder_data.city == 2 %}
                                            <div class="input-wrapper-city form-group col-lg-6" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                <label class="dark-text fsz-16 fw-500 mb-2" for="input-payment-city">
                                                    {% if oct_fastorder_data.city == 2 %}
{#                                                        <span class="required">*</span>#}
                                                    {% endif %}
                                                    {{ entry_city }}</label>
                                                <input type="text" name="city"
                                                       value="{% if city is defined and city %}{{ city }}{% elseif oct_fastorder_data.default_city is defined and oct_fastorder_data.default_city %}{{ oct_fastorder_data.default_city }}{% endif %}"
                                                       placeholder="{{ entry_city }}" id="input-payment-city"
                                                       class="form-control" inputmode="text">
                                            </div>
                                        {% else %}
                                            <input type="hidden" name="city"
                                                   value="{{ oct_fastorder_data.default_city }}"/>
                                        {% endif %}
                                        {% if oct_fastorder_data.address_1 == 1 or oct_fastorder_data.address_1 == 2 %}
                                            <div class="input-wrapper-address_1 form-group col-lg-6" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                <label class="dark-text fsz-16 fw-500 mb-2"
                                                       for="input-payment-address-1">
                                                    {% if oct_fastorder_data.address_1 == 2 %}
{#                                                        <span class="required">*</span>#}
                                                    {% endif %}
                                                    {{ entry_address_1 }}</label>
                                                <input type="text" name="address_1"
                                                       value="{% if address_1 is defined and address_1 %}{{ address_1 }}{% endif %}"
                                                       placeholder="{{ entry_address_1 }}" id="input-payment-address-1"
                                                       class="form-control" inputmode="text">
                                            </div>
                                        {% else %}
                                            <input type="hidden" name="address_1" value=""/>
                                        {% endif %}
                                        {% if oct_fastorder_data.address_2 == 1 or oct_fastorder_data.address_2 == 2 %}
                                            <div class="form-group col-lg-6" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                <label class="dark-text fsz-14 fw-500 mb-1"
                                                       for="input-payment-address-2">
                                                    {% if oct_fastorder_data.address_2 == 2 %}
                                                        <span class="required">*</span>
                                                    {% endif %}
                                                    {{ entry_address_2 }}</label>
                                                <input type="text" name="address_2"
                                                       value="{% if address_2 is defined and address_2 %}{{ address_2 }}{% endif %}"
                                                       placeholder="{{ entry_address_2 }}" id="input-payment-address-2"
                                                       class="form-control" inputmode="text">
                                            </div>
                                        {% else %}
                                            <input type="hidden" name="address_2" value=""/>
                                        {% endif %}
                                    {% endif %}

                                    {% if oct_fastorder_data.postcode == 1 or oct_fastorder_data.postcode == 2 %}
                                        <div class="input-wrapper-postcode form-group col-lg-6" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                            <label class="dark-text fsz-14 fw-500 mb-1" for="input-payment-postcode">
                                                {% if oct_fastorder_data.postcode == 2 %}
                                                    <span class="required">*</span>
                                                {% endif %}
                                                {{ entry_postcode }}</label>
                                            <input type="text" name="postcode"
                                                   value="{% if postcode is defined and postcode %}{{ postcode }}{% endif %}"
                                                   placeholder="{{ entry_postcode }}" id="input-payment-postcode"
                                                   class="form-control"/>
                                        </div>
                                    {% else %}
                                        <input type="hidden" name="postcode" value=""/>
                                    {% endif %}
                                    {% if custom_fields %}
                                        {% for custom_field in custom_fields %}
                                            {% if custom_field.location == 'address' %}
                                                {% if custom_field.type == 'select' %}
                                                    <div class="form-groupcustom-field col-lg-6" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? ' <span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <select name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                    id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                    class="form-control rm-select">
                                                                <option value="">{{ text_select }}</option>
                                                                {% for custom_field_value in custom_field['custom_field_value'] %}
                                                                    <option value="{{ custom_field_value.custom_field_value_id }}">
                                                                        {{ custom_field_value.name }}</option>
                                                                {% endfor %}
                                                            </select>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'radio' %}
                                                    <div class="form-group custom-field col-md-6" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                        <label class="dark-text fsz-14 fw-500 mb-1">{{ custom_field.required ? ' <span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <div id="input-payment-custom-field{{ custom_field.custom_field_id }}">
                                                                {% for custom_field_value in custom_field['custom_field_value'] %}
                                                                    <div class="form-check d-flex align-items-center mb-0">
                                                                        <label class="form-check-label d-flex align-items-center">
                                                                            <input type="radio" class="form-check-input"
                                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                                   value="{{ custom_field_value.custom_field_value_id }}"/>
                                                                            {{ custom_field_value.name }}</label>
                                                                    </div>
                                                                {% endfor %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'checkbox' %}
                                                    <div class="form-group custom-field col-md-6" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                        <label class="dark-text fsz-14 fw-500 mb-1">{{ custom_field.required ? ' <span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <div id="input-payment-custom-field{{ custom_field.custom_field_id }}">
                                                                {% for custom_field_value in custom_field['custom_field_value'] %}
                                                                    <div class="checkbox">
                                                                        <label>
                                                                            <input type="checkbox"
                                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                                   value="{{ custom_field_value.custom_field_value_id }}"/>
                                                                            {{ custom_field_value.name }}</label>
                                                                    </div>
                                                                {% endfor %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'text' %}
                                                    <div class="form-group custom-field col-lg-12" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? ' <span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <input type="text"
                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                   value="{{ custom_field.value }}"
                                                                   placeholder="{{ custom_field.name }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                   class="form-control" inputmode="text">
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'textarea' %}
                                                    <div class="form-group custom-field col-lg-12" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? ' <span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <textarea
                                                                    name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                    rows="5" placeholder="{{ custom_field.name }}"
                                                                    id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                    class="form-control">{{ custom_field.value }}</textarea>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'file' %}
                                                    <div class="form-group custom-field col-lg-12" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                        <label class="dark-text fsz-14 fw-500 mb-1">{{ custom_field.required ? ' <span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <button type="button"
                                                                    id="button-shipping-custom-field{{ custom_field.custom_field_id }}"
                                                                    class="sc-btn sc-btn-primary br-4">
                                                                <i class="fa fa-upload"></i>
                                                                {{ button_upload }}</button>
                                                            <input type="hidden"
                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                   value="{{ custom_field.value }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"/>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'date' %}
                                                    <div class="form-group custom-field col-lg-12" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? ' <span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <input type="date"
                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                   value="{{ custom_field.value }}"
                                                                   placeholder="{{ custom_field.name }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                   class="form-control"/>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'datetime' %}
                                                    <div class="form-group custom-field col-lg-12" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? ' <span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <input type="datetime-local"
                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                   value="{{ custom_field.value }}"
                                                                   placeholder="{{ custom_field.name }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                   class="form-control"/>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'time' %}
                                                    <div class="form-group custom-field col-lg-12" {% if customer_id and addresses %} style="display:none" {% endif %}>
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? ' <span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <input type="time"
                                                                   name="custom_field[{{ custom_field.custom_field_id }}]"
                                                                   value="{{ custom_field.value }}"
                                                                   placeholder="{{ custom_field.name }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                   class="form-control"/>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                            {% endif %}
                                        {% endfor %}
                                    {% endif %}
                                    {% if shipping_required %}
                                        <div class="col-sm-12">
                                            {% if not customer_id %}
                                                <div class="form-group" style="display:none;">
                                                    <label class="ms-0"><input type="checkbox" name="shipping_address"
                                                                               value="new" {% if address_id is defined and address_id %} checked="checked" {% endif %}
                                                                               onclick="$('.shipping-address').toggle()">
                                                        {{ text_address_new }}</label>
                                                </div>
                                            {% endif %}
                                            <div class="shipping-address" {% if (shipping_address_id is defined and shipping_address_id) or customer_id is defined %} style="display:block" {% else %} style="display:none" {% endif %}>
                                                {% if addresses %}
                                                    {% if customer_id %}
                                                        <div class="form-check d-flex align-items-center mb-0">
                                                            <label class="form-check-label ms-0 ps-0 mb-3 d-flex align-items-center">
                                                                <input type="radio" class="form-check-input"
                                                                       name="shipping_address" value="existing"
                                                                       checked="checked"
                                                                       onclick="$('#shipping-new').hide()"/>{{ text_address_existing_shipping }}
                                                            </label>
                                                        </div>
                                                        <div id="shipping-existing">
                                                            <select name="shipping_address_id"
                                                                    class="form-control form-select">
                                                                {% for address in addresses %}
                                                                    {% if shipping_address_id and address.address_id == shipping_address_id %}
                                                                        <option value="{{ address.address_id }}"
                                                                                selected="selected">
                                                                            {{ address.firstname }}{{ address.lastname }}
                                                                            ,
                                                                            {{ address.address_1 }},
                                                                            {{ address.city }},
                                                                            {{ address.zone }},
                                                                            {{ address.country }}</option>
                                                                    {% else %}
                                                                        <option value="{{ address.address_id }}">
                                                                            {{ address.firstname }}{{ address.lastname }}
                                                                            ,
                                                                            {{ address.address_1 }},
                                                                            {{ address.city }},
                                                                            {{ address.zone }},
                                                                            {{ address.country }}</option>
                                                                    {% endif %}
                                                                {% endfor %}
                                                            </select>
                                                        </div>
                                                    {% endif %}
                                                    {% if customer_id and total_addresses is defined and total_addresses > 0 %}
                                                        <div class="form-check d-flex align-items-center mb-0">
                                                            <label class="form-check-label ms-0 ps-0 mt-3 d-flex align-items-center">
                                                                <input type="radio"
                                                                       class="form-check-input shipping_address_new"
                                                                       name="shipping_address" value="new"
                                                                       onclick="$('#shipping-new').show();"/>{{ text_address_new }}
                                                            </label>
                                                        </div>
                                                    {% endif %}
                                                {% endif %}

                                                {% if customer_id and total_addresses is defined and total_addresses > 0 %}
                                                    <div id="shipping-new"
                                                         class="row mt-0 gx-3 gx-md-4 gy-3 px-2 px-md-0"
                                                         style="display: none;">
                                                        <div class="oct-fastorder-header fw-500 fsz-18">{{ text_shipping_address }}</div>

                                                        {% if oct_fastorder_data.country_and_region == 1 or oct_fastorder_data.country_and_region == 2 %}
                                                            <div class="form-group col-lg-6" {% if not show_country %} style="display:none" {% endif %}>
                                                                <label class="dark-text fsz-14 fw-500 mb-1"
                                                                       for="input-shipping-country"><span
                                                                            class="required">*</span>{{ entry_country }}
                                                                </label>
                                                                <select name="shipping_country_id"
                                                                        id="input-shipping-country"
                                                                        class="form-control rm-select">
                                                                    <option value="">{{ text_select }}</option>
                                                                    {% for country in countries %}
                                                                        {% if country.country_id == country_id %}
                                                                            <option value="{{ country.country_id }}"
                                                                                    selected="selected">{{ country.name }}</option>
                                                                        {% else %}
                                                                            <option value="{{ country.country_id }}">{{ country.name }}</option>
                                                                        {% endif %}
                                                                    {% endfor %}
                                                                </select>
                                                            </div>
                                                            <div class="input-shipping-zone form-group col-lg-6">
                                                                <label class="dark-text fsz-14 fw-500 mb-1"
                                                                       for="input-shipping-zone">
                                                                    <span class="required">*</span>
                                                                    {{ entry_zone }}</label>
                                                                <select name="shipping_zone_id" id="input-shipping-zone"
                                                                        class="form-control rm-select"></select>
                                                            </div>
                                                        {% else %}
                                                            <select name="shipping_country_id" style="display: none;">
                                                                <option value="{{ oct_fastorder_data.default_country }}"
                                                                        selected="selected"></option>
                                                            </select>
                                                            <select name="shipping_zone_id"
                                                                    style="display: none;"></select>
                                                        {% endif %}
                                                        <div class="input-shipping-firstname form-group col-lg-6">
                                                            <label class="dark-text fsz-14 fw-500 mb-1"
                                                                   for="input-shipping-firstname">
                                                                <span class="required">*</span>
                                                                {{ entry_firstname }}</label>
                                                            <input type="text" name="shipping_firstname" value=""
                                                                   placeholder="{{ entry_firstname }}"
                                                                   id="input-shipping-firstname" class="form-control"
                                                                   inputmode="text">
                                                        </div>
                                                        {% if oct_fastorder_data.lastname == 1 %}
                                                            <div class="input-shipping-lastname form-group col-lg-6">
                                                                <label class="dark-text fsz-14 fw-500 mb-1"
                                                                       for="input-shipping-lastname">
                                                                    <span class="required">*</span>
                                                                    {{ entry_lastname }}</label>
                                                                <input type="text" name="shipping_lastname" value=""
                                                                       placeholder="{{ entry_lastname }}"
                                                                       id="input-shipping-lastname" class="form-control"
                                                                       inputmode="text">
                                                            </div>
                                                        {% else %}
                                                            <input type="hidden" name="shipping_lastname" value=""/>
                                                        {% endif %}
                                                        {% if oct_fastorder_data.company == 1 %}
                                                            <div class="form-group col-lg-6">
                                                                <label class="dark-text fsz-14 fw-500 mb-1"
                                                                       for="input-shipping-company">{{ entry_company }}</label>
                                                                <input type="text" name="shipping_company" value=""
                                                                       placeholder="{{ entry_company }}"
                                                                       id="input-shipping-company" class="form-control"
                                                                       inputmode="text">
                                                            </div>
                                                        {% else %}
                                                            <input type="hidden" name="shipping_company" value=""/>
                                                        {% endif %}
                                                        {% if oct_fastorder_data.postcode == 1 %}
                                                            <div class="input-wrapper-postcode form-group col-lg-6">
                                                                <label class="dark-text fsz-14 fw-500 mb-1"
                                                                       for="input-shipping-postcode">{{ entry_postcode }}</label>
                                                                <input type="text" name="shipping_postcode"
                                                                       value="{{ postcode }}"
                                                                       placeholder="{{ entry_postcode }}"
                                                                       id="input-shipping-postcode" class="form-control"
                                                                       inputmode="text">
                                                            </div>
                                                        {% else %}
                                                            <input type="hidden" name="shipping_postcode" value=""/>
                                                        {% endif %}


                                                        {% if oct_fastorder_data.city == 1 or oct_fastorder_data.city == 2 %}
                                                            <div class="input-wrapper-city form-group col-lg-6">
                                                                <label class="dark-text fsz-16 fw-500 mb-2"
                                                                       for="input-shipping-city">
                                                                    {% if oct_fastorder_data.address_2 == 2 %}
                                                                        <span class="required">*</span>
                                                                    {% endif %}
                                                                    {{ entry_city }}</label>
                                                                <input type="text" name="city" value=""
                                                                       placeholder="{{ entry_city }}"
                                                                       id="input-shipping-city" class="form-control"
                                                                       inputmode="text">
                                                            </div>
                                                        {% else %}
                                                            <input type="hidden" name="city"
                                                                   value="{{ oct_fastorder_data.default_city }}"/>
                                                        {% endif %}

                                                        {% if oct_fastorder_data.address_1 == 1 or oct_fastorder_data.address_1 == 2 %}
                                                            <div class="input-wrapper-address_1 form-group col-lg-6">
                                                                <label class="dark-text fsz-14 fw-500 mb-1"
                                                                       for="input-shipping-address-1">
                                                                    {% if oct_fastorder_data.address_1 == 2 %}
                                                                        <span class="required">*</span>
                                                                    {% endif %}
                                                                    {{ entry_address_1 }}</label>
                                                                <input type="text" name="address_1" value=""
                                                                       placeholder="{{ entry_address_1 }}"
                                                                       id="input-shipping-address-1"
                                                                       class="form-control" inputmode="text">
                                                            </div>
                                                        {% else %}
                                                            <input type="hidden" name="address_1" value=""/>
                                                        {% endif %}

                                                        {% if oct_fastorder_data.address_2 == 1 or oct_fastorder_data.address_2 == 2 %}
                                                            <div class="form-group col-lg-6">
                                                                <label class="dark-text fsz-14 fw-500 mb-1"
                                                                       for="input-shipping-address-2">
                                                                    {% if oct_fastorder_data.address_2 == 2 %}
                                                                        <span class="required">*</span>
                                                                    {% endif %}
                                                                    {{ entry_address_2 }}</label>
                                                                <input type="text" name="address_2" value=""
                                                                       placeholder="{{ entry_address_2 }}"
                                                                       id="input-shipping-address-2"
                                                                       class="form-control" inputmode="text">
                                                            </div>
                                                        {% else %}
                                                            <input type="hidden" name="address_2" value=""/>
                                                        {% endif %}

                                                    </div>
                                                {% endif %}

                                            </div>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-4 order-{{ user_block_sort+2 }}">
                        <div class="col-12 mt-4 mt-md-0  order-0 order-lg-1">
                            <div class="oct-checkout-block h-100 payment-method">
                                <div class="oct-checkout-block-title d-flex align-items-center mb-4">
                                    <img src="catalog/view/theme/oct_showcase/img/sprite-fastorder.svg#include--payment-icon"
                                         alt="" width="24" height="24">
                                    <span class="text-uppercase- ps-3">{{ heading_payment_block }}</span>
                                </div>
                                {% if error_warning %}
                                    <div class="alert alert-warning fsz-14">
                                        <i class="fa fa-exclamation-circle"></i>
                                        {{ error_warning }}</div>
                                {% endif %}
                                {% if payment_methods %}
                                    <p class="mb-3">{{ text_payment_method }}</p>
                                    {% for payment_method in payment_methods %}
                                        <div class="form-check d-flex align-items-start ps-3 flex-column">
                                            <label class="form-check-label d-flex align-items-center">
                                                {% if payment_method.code == code or  not code %}
                                                    {% set code = payment_method.code %}
                                                    <input type="radio" class="form-check-input" name="payment_method"
                                                           value="{{ payment_method.code }}"
                                                           title="{{ payment_method.title }}" checked="checked"/>
                                                {% else %}
                                                    <input type="radio" class="form-check-input" name="payment_method"
                                                           value="{{ payment_method.code }}"
                                                           title="{{ payment_method.title }}"/>
                                                {% endif %}
                                                {{ payment_method.title }}
                                            </label>
                                            {% if payment_method.code == 'cod' %}
                                                <span style="font-size: 11px; color: #CECECF; padding-left: 6px;">{{ text_payment_on_delivery }}</span>
                                            {% endif %}
                                        </div>
                                    {% endfor %}
                                {% endif %}
                            </div>
                        </div>
                    </div>


                    <div class="row mb-4 order-4">

                        <div class="col-12">
                            <div class="oct-checkout-block">

                                <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-md-between">
                                    <div class="oct-checkout-block-title d-flex align-items-center mb-md-0">
                                        <img style="padding: 2px" src="/image/Icons/comment.svg" alt="" width="24" height="24" plerdy-tracking-id="20183611901">
                                        <span class="text-uppercase-">{{ text_comments }}</span>
                                    </div>

                                </div>
                                {% if oct_fastorder_data.comment == 1 %}
                                    <div class="form-group col-lg-12 mt-3">
                                        <textarea name="comment" rows="4" class="form-control">{{ comment }}</textarea>


                                        <div class="custom_fields mt-2">
                                        {% if custom_fields %}
                                            {% for custom_field in custom_fields %}
                                                {% if custom_field.location == 'account' %}
                                                {% if custom_field.type == 'select' %}
                                                    <div class="form-group custom-field col-lg-12">
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? '<span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <select name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                    id="input-custom-field{{ custom_field.custom_field_id }}"
                                                                    class="form-control rm-select">
                                                                <option value="">{{ text_select }}</option>
                                                                {% for custom_field_value in custom_field['custom_field_value'] %}
                                                                    {% if account_custom_field[custom_field.custom_field_id] and custom_field_value.custom_field_value_id == account_custom_field[custom_field.custom_field_id] %}
                                                                        <option value="{{ custom_field_value.custom_field_value_id }}"
                                                                                selected="selected">{{ custom_field_value.name }}</option>
                                                                    {% else %}
                                                                        <option value="{{ custom_field_value.custom_field_value_id }}">
                                                                            {{ custom_field_value.name }}</option>
                                                                    {% endif %}
                                                                {% endfor %}
                                                            </select>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'radio' %}
                                                    <div class="form-group custom-field col-lg-12">
                                                        <label class="dark-text fsz-14 fw-500 mb-1">{{ custom_field.required ? '<span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <div id="input-payment-custom-field{{ custom_field.custom_field_id }}">
                                                                {% for custom_field_value in custom_field['custom_field_value'] %}
                                                                    <div class="form-check d-flex align-items-center mb-0">
                                                                        {% if account_custom_field[custom_field.custom_field_id] and custom_field_value.custom_field_value_id == account_custom_field[custom_field.custom_field_id] %}
                                                                            <label class="form-check-label d-flex align-items-center">
                                                                                <input type="radio" class="form-check-input"
                                                                                       name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                                       value="{{ custom_field_value.custom_field_value_id }}"
                                                                                       checked="checked"/>
                                                                                {{ custom_field_value.name }}</label>
                                                                        {% else %}
                                                                            <label class="form-check-label d-flex align-items-center">
                                                                                <input type="radio" class="form-check-input"
                                                                                       name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                                       value="{{ custom_field_value.custom_field_value_id }}"/>
                                                                                {{ custom_field_value.name }}</label>
                                                                        {% endif %}
                                                                    </div>
                                                                {% endfor %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'checkbox' %}
                                                    <div class="form-group custom-field col-lg-12">
                                                        <label class="dark-text fsz-14 fw-500 mb-1">{{ custom_field.required ? '<span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <div id="input-payment-custom-field{{ custom_field.custom_field_id }}">
                                                                {% for custom_field_value in custom_field['custom_field_value'] %}
                                                                    <div class="checkbox">
                                                                        {% if account_custom_field[custom_field.custom_field_id] and custom_field_value.custom_field_value_id in account_custom_field[custom_field.custom_field_id] %}
                                                                            <label>
                                                                                <input type="checkbox"
                                                                                       name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                                       value="{{ custom_field_value.custom_field_value_id }}"
                                                                                       checked="checked"/>
                                                                                {{ custom_field_value.name }}</label>
                                                                        {% else %}
                                                                            <label>
                                                                                <input type="checkbox"
                                                                                       name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                                       value="{{ custom_field_value.custom_field_value_id }}"/>
                                                                                {{ custom_field_value.name }}</label>
                                                                        {% endif %}
                                                                    </div>
                                                                {% endfor %}
                                                            </div>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'text' %}
                                                    <div class="form-group custom-field col-lg-12 {% if custom_field.custom_field_id == 1 %}hidden{% endif %}">
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? '<span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <input type="text"
                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                   value="{{ account_custom_field[custom_field.custom_field_id] ? account_custom_field[custom_field.custom_field_id] : custom_field.value }}"
                                                                   placeholder="{{ custom_field.name }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                   class="form-control" inputmode="text">
                                                        </div>
                                                    </div>
                                                {% if custom_field.custom_field_id == 1 %}
                                                    <div class="form-group custom-field col-lg-12 order-5 mt-3">
                                                        <label for="no_call">
                                                            <input type="checkbox" name="no_call" class="form-check-input" id="no_call" checked>
                                                            {{ custom_field.name }}
                                                        </label>

                                                        <div class="no_call_notice fsz-12">
                                                            {{ no_call_notice }}
                                                        </div>
                                                    </div>
                                                    <script>
                                                        $('#no_call').click(function () {
                                                            if ($(this).prop('checked') == true) {
                                                                $('#input-payment-custom-field{{ custom_field.custom_field_id }}').val('Підтверджую без дзвінка менеджера')
                                                            } else {
                                                                $('#input-payment-custom-field{{ custom_field.custom_field_id }}').val('-')
                                                            }
                                                        });
                                                    </script>
                                                {% endif %}

                                                {% endif %}
                                                {% if custom_field.type == 'textarea' %}
                                                    <div class="form-group custom-field col-lg-12">
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? '<span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                        <textarea
                                                                name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                rows="5" placeholder="{{ custom_field.name }}"
                                                                id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                class="form-control">{{ account_custom_field[custom_field.custom_field_id] ? account_custom_field[custom_field.custom_field_id] : custom_field.value }}</textarea>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'file' %}
                                                    <div class="form-group custom-field col-lg-12">
                                                        <label class="dark-text fsz-14 fw-500 mb-1">{{ custom_field.required ? '<span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <button type="button"
                                                                    id="button-shipping-custom-field{{ custom_field.custom_field_id }}"
                                                                    class="sc-btn sc-btn-primary br-4">
                                                                <i class="fa fa-upload"></i>
                                                                {{ button_upload }}</button>
                                                            <input type="hidden"
                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                   value="{{ custom_field.value }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"/>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'date' %}
                                                    <div class="form-group custom-field col-lg-12">
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? '<span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <input type="date"
                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                   value="{{ account_custom_field[custom_field.custom_field_id] ? account_custom_field[custom_field.custom_field_id] : custom_field.value }}"
                                                                   placeholder="{{ custom_field.name }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                   class="form-control"/>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'datetime' %}
                                                    <div class="form-group custom-field col-lg-12">
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? '<span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <input type="datetime-local"
                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                   value="{{ account_custom_field[custom_field.custom_field_id] ? account_custom_field[custom_field.custom_field_id] : custom_field.value }}"
                                                                   placeholder="{{ custom_field.name }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                   class="form-control"/>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% if custom_field.type == 'time' %}
                                                    <div class="form-group custom-field col-lg-12">
                                                        <label class="dark-text fsz-14 fw-500 mb-1"
                                                               for="input-payment-custom-field{{ custom_field.custom_field_id }}">{{ custom_field.required ? '<span class="required">*</span>' : '' }}{{ custom_field.name }}</label>
                                                        <div class="">
                                                            <input type="time"
                                                                   name="custom_field[{{ custom_field.location }}][{{ custom_field.custom_field_id }}]"
                                                                   value="{{ account_custom_field[custom_field.custom_field_id] ? account_custom_field[custom_field.custom_field_id] : custom_field.value }}"
                                                                   placeholder="{{ custom_field.name }}"
                                                                   id="input-payment-custom-field{{ custom_field.custom_field_id }}"
                                                                   class="form-control"/>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                                {% endif %}
                                            {% endfor %}
                                        {% endif %}
                                        </div>

                                    </div>
                                {% else %}
                                    <textarea name="comment" rows="4" class="form-control"
                                              style="display:none;"></textarea>
                                {% endif %}
                            </div>



                        </div>
                    </div>

                    {% if oct_fastorder_data.cart_view_is and oct_fastorder_data.cart_view_is == 1 %}
                        {% if attention %}
                            <div class="alert alert-info">
                                <i class="fa fa-info-circle"></i>
                                {{ attention }}
                                <button type="button" class="close" data-dismiss="alert">&times;</button>
                            </div>
                        {% endif %}
                        {% if error_warning %}
                            <div class="alert alert-danger d-flex align-items-center fsz-14 mt-4">
                                <i class="fa fa-exclamation-circle me-2"></i>
                                {{ error_warning }}
                                <button type="button" class="close sc-btn sc-btn-transparent no-btn ms-auto red fsz-16"
                                        data-bs-dismiss="alert">&times;
                                </button>
                            </div>
                        {% endif %}
                        <div id="cart-table" class="d-none order-{{ cart_block_sort }}">
                            {% for product in products %}
                                <div class="row mb-4">
                                    <div class="col-lg-12">
                                        <div class="oct-checkout-block oct-checkout-cart d-flex flex-column flex-md-row justify-content-between p-3">
                                            <div class="oct-checkout-cart-product-info d-flex align-items-md-center">
                                                {% if product.thumb %}
                                                    <a href="{{ product.href }}"><img src="{{ product.thumb }}"
                                                                                      alt="{{ product.name }}"
                                                                                      title="{{ product.name }}"
                                                                                      width="60" height="60"/></a>
                                                {% endif %}
                                                <div class="ps-3">
                                                    <a href="{{ product.href }}"
                                                       class="blue-link d-block mb-2">{{ product.name }}</a>
                                                    {% if not product.stock %}
                                                        <span class="required">***</span>
                                                    {% endif %}

                                                    {% if product.option %}
                                                        {% for option in product['option'] %}
                                                            <div class="oct-checkout-cart-product-option">
                                                                {{ option.name }}:
                                                                <span class="light-text">{{ option.value }}</span>
                                                                {% if oct_advanced_options_settings_data.status and oct_advanced_options_settings_data.status and oct_advanced_options_settings_data.quantity_status and option.oct_quantity_value and option.oct_quantity_value %}
                                                                    x{{ option.oct_quantity_value }}
                                                                {% endif %}
                                                                {% if oct_advanced_options_settings_data.status and oct_advanced_options_settings_data.status and oct_advanced_options_settings_data.allow_sku and option.sku or oct_advanced_options_settings_data.status and oct_advanced_options_settings_data.status and oct_advanced_options_settings_data.allow_model and option.model %}(
                                                                    {% if oct_advanced_options_settings_data.allow_sku and option.sku %}
                                                                        {{ text_option_sku }}:
                                                                        {{ option.sku }},
                                                                    {% endif %}
                                                                    {% if oct_advanced_options_settings_data.allow_model and option.model %}
                                                                        {{ text_option_model }}:
                                                                        {{ option.model }}
                                                                    {% endif %})
                                                                {% endif %}
                                                                </small>
                                                            </div>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if product.reward %}
                                                        <br/>
                                                        <small>{{ product.reward }}</small>
                                                    {% endif %}
                                                    {% if product.recurring %}
                                                        <br/>
                                                        <small>{{ text_recurring_item }}{{ product.recurring }}</small>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="oct-checkout-cart-actions">
                                                <div class="oct-checkout-cart-buttons d-flex align-items-stretch justify-content-end">
                                                    <div class="oct-checkout-cart-quantity d-flex align-items-center justify-content-center">
                                                        <input name="product_id_q" value="{{ product.product_id }}"
                                                               style="display: none;" type="hidden"/>
                                                        <input name="product_id" value="{{ product.key }}"
                                                               style="display: none;" type="hidden"/>
                                                        <input id="quantity-{{ product.quantity }}" type="text"
                                                               name="quantity" value="{{ product.quantity }}"
                                                               class="form-control"
                                                               onchange="update_manual(this, '{{ product.key }}');"
                                                               aria-label="Quantity" inputmode="numeric">
                                                    </div>
                                                    <button type="button" aria-label="Delete"
                                                            class="sc-btn sc-btn-danger sc-btn-with-icon br-4 oct-checkout-cart-delete-btn"
                                                            onclick="update(this, 'remove');">
                                                        <span class="sc-btn-icon sc-btn-icon-del"></span>
                                                    </button>
                                                </div>
                                                <div class="oct-checkout-cart-total">{{ column_total }}
                                                    {{ product.total }}</div>
                                                <div class="oct-checkout-cart-price">{{ column_price }}
                                                    {{ product.price }}</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="col-lg-4">
                <div class="oct-checkout-column mt-4 mt-md-0">

                    <div class="oct-checkout-block oct-checkout-block-products  oct-checkout-actions">

                        <div class="d-flex justify-content-between align-items-center">
                            <div class="checkout-cart-title">{{ text_cart }}</div>
                            <a href="{{ edit_cart_link }}" class="checkout-cart-edit">{{ text_edit_cart }}</a>
                        </div>

                        <div class="checkout-notice">

                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20Z" stroke="#C0C0C0" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 16V12M12 8H12.012" stroke="#C0C0C0" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>

                            {{ cart_notice }}
                        </div>


                        <div class="sc-cart-items">
                            {% for product in products %}
                                <div class="popup-cart-item">
                                    <div class="d-flex">

                                        <div class="popup-cart-image-wrapper d-flex flex-column">
                                            {% if product.thumb %}
                                                <img class="popup-cart-image" src="{{ product.thumb }}" alt="{{ product.name }}"/>
                                            {% endif %}
                                        </div>
                                        <div class="sidebar-cart-item-right fsz-12 ps-3 flex-grow-1">
                                            <div class="sidebar-cart-info">
                                                <div class="sidebar-cart-item-title fw-500 fsz-14">
                                                    <a href="{{ product.href }}">{{ product.name }}</a>
                                                    <div class="popup-cart-product-model">Код товару: {{ product.model }}</div>

                                                    {#															<div class="popup-cart-product-model">{{ product.total }}</div>#}

                                                    {% if product.special > 0 %}
                                                        <div class="sc-module-price-km">
                                                            <div class="sc-module-price-km-prices">
                                                                <div class="km-price-linethrow">{{ product.price_text }}</div>
                                                                <div class="km-price-special">{{ product.special_text }}</div>
                                                            </div>
                                                            <div class="sc-module-price-km-usdt">
                                                                {{ product.usdt }} usdt
                                                            </div>
                                                            <div class="ml-a">{{ product.quantity }} шт.</div>
                                                        </div>
                                                    {% else %}
                                                        <div class="sc-module-price-km">
                                                            <div class="sc-module-price-km-prices">
                                                                <div class="km-price-regular fw-500">{{ product.price_text }}</div>
                                                            </div>
                                                            <div class="sc-module-price-km-usdt">
                                                                {{ product.usdt }} usdt
                                                            </div>
                                                            <div class="ml-a">{{ product.quantity }} шт.</div>
                                                        </div>
                                                    {% endif %}


                                                    {% if not product.stock %}
                                                        <span class="required">***</span>
                                                    {% endif %}
                                                </div>

                                                {% if product.option %}
                                                    {% for option in product.option %}
                                                        <div class="sidebar-cart-item-option"><span class="dark-text">{{ option.name }}:</span> {{ option.value }}</div>
                                                    {% endfor %}
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                            {% for voucher in vouchers %}
                                <div class="sc-cart-item content-block p-2 p-md-3">
                                    <div class="d-flex align-items-center">
                                        <button type="button" class="sc-btn sc-btn-danger sc-btn-with-icon br-4" onclick="voucher.remove('{{ voucher.key }}');"><span class="sc-btn-icon sc-btn-icon-del"></span></button>
                                        <div class="dark-text fw-500 ms-2 ms-md-3">{{ voucher.description }}</div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>

                        <div class="oct-checkout-actions-title d-none">{{ text_next }}</div>
                        {% if modules %}
                            <p class="mt-3 pb-3 d-none">{{ text_next_choice }}</p>
                            {% set key_step = key_step + 1 %}
                            <div class="panel-group fastorder-panel-group" id="accordion">
                                {% for module in modules %}
                                    {{ module }}
                                {% endfor %}
                            </div>
                            <script>
                                window.addEventListener('DOMContentLoaded', () => {
                                    $('.sc-cart-actions-block-title').on('click', function (e) {
                                        $(this).toggleClass('clicked');
                                        $(this).next().toggleClass('opened');
                                    });
                                });
                            </script>
                        {% endif %}
                        <div class="oct-checkout-actions-total">
                            {% for total in totals %}
                                <div class="oct-checkout-actions-total-item d-flex justify-content-between">
                                    <span class="light-text">{{ total.title }}</span>
                                    <span id="{{ total.total_sum ? 'total-sum-span-wrapper-must-be-unique' : '' }}">{{ total.text }}</span>
                                </div>
                            {% endfor %}
                            {% if weight %}
                                <div class="oct-checkout-actions-total-item d-flex justify-content-between">
                                    <span class="light-text">{{ text_weight }}</span>
                                    <span>{{ weight }}</span>
                                </div>
                            {% endif %}


                        </div>
                        <div class="oct-checkout-actions-total-item d-flex justify-content-between end-total">
                            <span class="light-text">{{ full_total }}:</span>
                            <span>{{ end_total }}</span>
                        </div>



                        <div class="oct-fastorder-payment">
                            {% if payment and payment %}
                                <p>{{ payment }}</p>
                            {% else %}
                                <button type="button" class="sc-btn sc-btn-primary br-4 mt-3 w-100" id="button-go">
                                    <span class="sc-btn-text">{{ button_checkout }}</span>
                                </button>
                            {% endif %}
                        </div>

                        {% if text_agree %}
                            <div id="agree-block" class="form-check d-flex mt-3">
                                {% if agree %}
                                    <input id="checkoutCheckbox" class="form-check-input" type="checkbox" name="agree"
                                           value="1" checked="checked"/>
                                {% else %}
                                    <input id="checkoutCheckbox" class="form-check-input" type="checkbox" name="agree"
                                           value="1" checked="checked"/>
                                {% endif %}
                                <label class="form-check-label" for="checkoutCheckbox">{{ text_agree }}</label>
                            </div>
                        {% endif %}

                        {% if text_payment_agree %}
                            <div id="payment_agree-block" class="form-check mt-3 d-flex">
                                {% if payment_agree %}
                                    <input id="checkoutCheckboxPAyment" class="form-check-input" type="checkbox"
                                           name="payment_agree" value="1" checked="checked"/>
                                {% else %}
                                    <input id="checkoutCheckboxPAyment" class="form-check-input" type="checkbox"
                                           name="payment_agree" value="1"/>
                                {% endif %}
                                <label class="form-check-label"
                                       for="checkoutCheckboxPAyment">{{ text_payment_agree }}</label>
                            </div>
                        {% endif %}

                        <div id="additinonal-wait" class="payment-processing d-none d-block mt-4 align-center">
                            {{ additinal_wait_text }}
                            <span class="sc-loader mt-4 d-block m-auto"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {{ content_bottom }}
    </main>
</div>


{% if mask %}
    <script>
        scInputMask('#input-payment-telephone', '{{ mask }}');
    </script>
{% endif %}
<script>
    <!--
    var error = true;
    $(".oct-checkout .form-control, .oct-checkout .form-check-input").on("change paste keyup", function () {
        $(this).removeClass('error_style');
    });

    $('#mono_checkout_cart_page').on('click', function () {
        var monoCheckoutFbqValue = $('#total-sum-span-wrapper-must-be-unique').text().replaceAll('грн', '').replaceAll(' ', '').trim();
        fbq('track', 'mono_checkout', {
            currency: "UAH",
            value: Number(monoCheckoutFbqValue)
        });
    });

    // Register
    document.getElementById('button-go').addEventListener('click', function () {
        // console.log('click button-go');
        var data = $(
            '.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'tel\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select'
        ).serialize();
        data += '&_shipping_method=' + $('.oct-checkout input[name=\'shipping_method\']:checked').prop('title') +
            '&_payment_method=' + $('.oct-checkout input[name=\'payment_method\']:checked').prop('title');

        $.ajax({
            url: 'index.php?route=checkout/oct_fastorder/validate_form',
            type: 'post',
            data: data,
            dataType: 'json',
            beforeSend: function () {
                $('#button-go').button('loading');
                masked('body', true);
            },
            complete: function () {
                $('#button-go').button('reset');
                masked('body', false);
            },
            success: function (json) {
                $('.alert, .text-danger').remove();
                $('.register_block input, .register_block select').parent().removeClass('error_style');


                if (json['redirect']) {
                    location = json['redirect'];
                } else if (json['error']) {

                    if ((!json['error']['agree']) && (!json['error']['warning_agree'])) {
                        scrollToElement('.oct-checkout-block');
                    }

                    error = true;

                    if (json['error']['warning_agree']) {
                        scNotify('warning', json['error']['warning_agree']);
                        $('#checkoutCheckbox').addClass('error_style');
                    }

                    if (json['error']['agree']) {
                        scNotify('warning', json['error']['agree']);
                        $('#checkoutCheckbox').addClass('error_style');
                    }

                    if (json['error']['warning_user_exist']) {
                        scrollToElement('.oct-checkout-block');
                        scNotify('warning', json['error']['warning_user_exist']);
                        $('#input-payment-email').addClass('error_style');
                    }

                    if (json['error']['warning_payment_agree']) {
                        scNotify('warning', json['error']['warning_payment_agree']);
                        $('#checkoutCheckbox').addClass('error_style');
                    }

                    for (i in json['error']) {
                        // $('[name="' + i + '"]').after('<div class="text-danger">' + json['error'][i] + '</div>');
                        $('.oct-checkout .form-control[name="' + i + '"]').addClass('error_style');
                    }

                    if (json['error']['custom_field']) {
                        for (i in json['error']['custom_field']) {
                            // $('[name="' + i + '"]').after('<div class="text-danger">' + json['error'][i] + '</div>');
                            $('.oct-checkout .form-control#input-payment-custom-field' + i +
                                ', .oct-checkout .form-control#input-custom-field' + i +
                                ', .oct-checkout #input-payment-custom-field' + i + ' label').addClass(
                                'error_style');
                        }
                    }
                } else {
                    fbq('track', 'Purchase', {
                        currency: "UAH",
                        value: $('#total-sum-span-wrapper-must-be-unique').text().replaceAll('грн', '').replaceAll(' ', '').trim()
                    });

                    error = false;
                    $('[name=\'payment_method\']:checked').click();

                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                // alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            }
        });
    });

    $('select[name=\'country_id\']').on('change', function () {
        $.ajax({
            url: 'index.php?route=checkout/oct_fastorder/country&country_id=' + this.value,
            dataType: 'json',
            beforeSend: function () {
                $('select[name=\'country_id\']').after(' <i class="fa fa-spinner fa-spin"></i>');
            },
            complete: function () {
                $('.fa-spinner').remove();
            },
            success: function (json) {

                {% if oct_fastorder_data.postcode == 1 %}
                if (json['postcode_required'] == '1') {
                    $('input[name=\'postcode\']').parent().addClass('required');
                } else {
                    $('input[name=\'postcode\']').parent().removeClass('required');
                }
                {% endif %}

                html = '<option value="">{{ text_select }}</option>';

                if (json['zone'] && json['zone'] != '') {
                    for (i = 0; i < json['zone'].length; i++) {
                        html += '<option value="' + json['zone'][i]['zone_id'] + '"';

                        if (json['zone'][i]['zone_id'] ==
                            '{{ oct_fastorder_data.country_and_region == 1 ? zone_id : oct_fastorder_data.default_region }}'
                        ) {
                            html += ' selected="selected"';
                        }

                        html += '>' + json['zone'][i]['name'] + '</option>';
                    }
                } else {
                    html += '<option value="0" selected="selected">{{ text_none }}</option>';
                }

                {% if oct_fastorder_data.country_and_region == 1 or oct_fastorder_data.country_and_region == 2 %}
                $('select[name=\'zone_id\']').html(html).val('');
                {% else %}
                $('select[name=\'zone_id\']').html(html);
                $('select[name=\'zone_id\']').trigger('change');
                {% endif %}
                //$('select[name=\'shipping_country_id\']').val('');
            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            }
        });
    });

    $('select[name=\'country_id\']').trigger('change');

    $('select[name=\'shipping_country_id\']').on('change', function () {
        $.ajax({
            url: 'index.php?route=checkout/oct_fastorder/country&country_id=' + this.value,
            dataType: 'json',
            beforeSend: function () {
                $('select[name=\'country_id\']').after(' <i class="fa fa-spinner fa-spin"></i>');
            },
            complete: function () {
                $('.fa-spinner').remove();
            },
            success: function (json) {

                {% if oct_fastorder_data.postcode == 1 %}
                if (json['postcode_required'] == '1') {
                    $('input[name=\'postcode\']').parent().addClass('required');
                } else {
                    $('input[name=\'postcode\']').parent().removeClass('required');
                }
                {% endif %}

                html = '<option value="">{{ text_select }}</option>';

                if (json['zone'] && json['zone'] != '') {
                    for (i = 0; i < json['zone'].length; i++) {
                        html += '<option value="' + json['zone'][i]['zone_id'] + '"';

                        if (json['zone'][i]['zone_id'] ==
                            '{{ oct_fastorder_data.country_and_region == 1 ? zone_id : oct_fastorder_data.default_region }}'
                        ) {
                            html += ' selected="selected"';
                        }

                        html += '>' + json['zone'][i]['name'] + '</option>';
                    }
                } else {
                    html += '<option value="0" selected="selected">{{ text_none }}</option>';
                }

                {% if oct_fastorder_data.country_and_region == 1 or oct_fastorder_data.country_and_region == 2 %}
                $('select[name=\'shipping_zone_id\']').html(html).val('');
                {% else %}
                $('select[name=\'shipping_zone_id\']').html(html);
                {% endif %}
            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
            }
        });
    });

    $('select[name=\'shipping_country_id\']').trigger('change');

    $('select[name=\'country_id\'], select[name=\'zone_id\'], select[name=\'shipping_country_id\'], select[name=\'shipping_zone_id\'], input[type=\'radio\'][name=\'payment_address\'], input[type=\'radio\'][name=\'shipping_address\']').on('change', function () {

        if ($(this).attr("name") == 'country_id') {
            $("select[name=\'zone_id\']").val('');
        }

        if ($(this).attr("name") == 'shipping_country_id') {
            $("select[name=\'shipping_zone_id\']").val('');
        }
        {% if refresh_after_addnew_address %}
        $(".shipping-method").load('index.php?route=checkout/oct_fastorder/shipping_method', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, input[name=\'shipping_method\']:first, .oct-checkout textarea, .oct-checkout select'), function () {
            if ($("input[name=\'shipping_method\']:first").length) {
                $("input[name=\'shipping_method\']:first").attr('checked', 'checked').prop('checked', true).click();
            } else {
                $("#cart-table").load('index.php?route=checkout/oct_fastorder/cart', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select'));
            }
        });

        $(".payment-method").load('index.php?route=checkout/oct_fastorder/payment_method', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, input[name=\'shipping_method\']:first, .oct-checkout textarea, .oct-checkout select'), function () {
            $('input[name=\'payment_method\']:first').attr('checked', 'checked').prop('checked', true).click();
        });
        {% endif %}
    });

    {% if customer_id %}
    $(function () {
        $('select[name=\'shipping_address_id\']').trigger('change');
    });


    $('select[name=\'shipping_address_id\']').on('change', function () {
        $(".shipping-method").load('index.php?route=checkout/oct_fastorder/shipping_method', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, input[name=\'shipping_method\']:first, .oct-checkout textarea, .oct-checkout select'), function () {
            if ($("input[name=\'shipping_method\']:first").length) {
                $("input[name=\'shipping_method\']:first").attr('checked', 'checked').prop('checked', true).click();
            } else {
                $("#cart-table").load('index.php?route=checkout/oct_fastorder/cart', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select'));
            }
        });
    });
    {% endif %}

    {% if refresh_after_citychange %}
    $('input[name=\'city\'], input[name=\'shipping_city\']').on('change', function () {
        $(".shipping-method").load('index.php?route=checkout/oct_fastorder/shipping_method', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, input[name=\'shipping_method\']:first, .oct-checkout textarea, .oct-checkout select'), function () {
            if ($("input[name=\'shipping_method\']:first").length) {
                $("input[name=\'shipping_method\']:first").attr('checked', 'checked').prop('checked', true).click();
            } else {
                $("#cart-table").load('index.php?route=checkout/oct_fastorder/cart', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select'));
            }
        });
    });
    {% endif %}

    $(document).delegate('input[name=\'shipping_method\']', 'click', function () {
        $('[data-bs-dismiss="alert"]').click();
        $("#cart-table").load('index.php?route=checkout/oct_fastorder/cart', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select'));
    });

    $('body').delegate('input[name=\'payment_method\']', 'click', function () {
        var data = $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'tel\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select').serialize();
        data += '&_shipping_method=' + $('.oct-checkout input[name=\'shipping_method\']:checked').prop('title') + '&_payment_method=' + $('.oct-checkout input[name=\'payment_method\']:checked').prop('title');

        if (!error) {
            $.ajax({
                url: 'index.php?route=checkout/oct_fastorder/confirm',
                type: 'post',
                data: data,
                success: function (html) {
                    $(".oct-fastorder-payment").html(html).addClass('d-none');
                    if ($(".oct-fastorder-payment input[type=button]").length > 0) {
                        $(".oct-fastorder-payment input[type=button]").click();
                    }
                    if ($(".oct-fastorder-payment input[type=submit]").length > 0) {
                        $(".oct-fastorder-payment input[type=submit]").click();
                    }
                    if ($(".oct-fastorder-payment a#process").length > 0) {
                        setTimeout(function () {
                            $(".oct-fastorder-payment a#process").click();
                        }, 100)
                        masked('body', true);
                    }
                    masked('body', true);
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                }
            });
        }

    });
    $(document).ready(function () {
        $('input:radio[name=\'payment_method\']:first').attr('checked', true).prop('checked', true);
    });
    //
    -->
</script>
<script><!--
function update(target, status) {
    let input_val = $(target).parent().parent().children('input[name=quantity]').val(),
        quantity = parseInt(input_val),
        product_id = $(target).parent().parent().parent().children('input[name=product_id]').val(),
        product_id_q = $(target).parent().parent().parent().children('input[name=product_id_q]').val(),
        product_key = $(target).parent().parent().find('input[name=product_id]').val(),
        urls = null;

    if (quantity <= 0) {
        quantity = $(target).parent().parent().children('input[name=quantity]').val(1);
        return;
    }

    if (status == 'update') {
        urls = 'index.php?route=checkout/oct_fastorder/cart&update=' + product_id + '&quantity=' + quantity;
    } else if (status == 'add') {
        urls = 'index.php?route=checkout/oct_fastorder/cart&add=' + target + '&quantity=1';
    } else {
        urls = 'index.php?route=checkout/oct_fastorder/cart&remove=' + product_key;
    }

    $.ajax({
        url: urls,
        type: 'get',
        dataType: 'html',
        beforeSend: function () {
            masked('body', true);
        },
        success: function (data) {
            $.ajax({
                url: 'index.php?route=checkout/oct_fastorder/status_cart',
                type: 'get',
                dataType: 'json',
                success: function (json) {
                    if (json['total']) {
                        setTimeout(function () {
                            $('#cart .header-buttons-cart-quantity').html(json['total']);
                            // $('.rm-cart-text').html(json['total_amount']);
                        }, 100);
                    }
                    if (!json['redirect']) {
                        masked('body', false);
                        $(".shipping-method").load('index.php?route=checkout/oct_fastorder/shipping_method', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, input[name=\'shipping_method\']:first, .oct-checkout textarea, .oct-checkout select'), function () {
                            if ($("input[name=\'shipping_method\']:first").length) {
                                $("input[name=\'shipping_method\']:first").attr('checked', 'checked').prop('checked', true).click();
                            } else {
                                $("#cart-table").load('index.php?route=checkout/oct_fastorder/cart', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select'));
                            }
                        });

                    } else {
                        location = json['redirect'];
                    }
                }
            });
        }
    });
}

    function update_manual(target, product_id) {
        let input_val = $(target).val(),
            quantity = parseInt(input_val);

        if (quantity <= 0 || isNaN(quantity)) {
            quantity = $(target).val(1);
            return;
        }

        $.ajax({
            url: 'index.php?route=checkout/oct_fastorder/cart&update=' + product_id + '&quantity=' + quantity,
            type: 'get',
            dataType: 'html',
            beforeSend: function () {
                $('[data-bs-dismiss="alert"]').click();
                masked('body', true);
            },
            success: function (data) {
                $.ajax({
                    url: 'index.php?route=checkout/oct_fastorder/status_cart',
                    type: 'get',
                    dataType: 'json',
                    success: function (json) {
                        if (json['total']) {
                            setTimeout(function () {
                                $('#cart .header-buttons-cart-quantity').html(json['total']);
                                // $('.rm-cart-text').html(json['total_amount']);
                            }, 100);
                        }
                        if (!json['redirect']) {
                            masked('body', false);
                            $(".shipping-method").load('index.php?route=checkout/oct_fastorder/shipping_method', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, input[name=\'shipping_method\']:first, .oct-checkout textarea, .oct-checkout select'), function () {
                                if ($("input[name=\'shipping_method\']:first").length) {
                                    $("input[name=\'shipping_method\']:first").attr('checked', 'checked').prop('checked', true).click();
                                } else {
                                    $("#cart-table").load('index.php?route=checkout/oct_fastorder/cart', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select'));
                                }
                            });
                            $(".payment-method").load('index.php?route=checkout/oct_fastorder/payment_method', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, input[name=\'shipping_method\']:first, .oct-checkout textarea, .oct-checkout select'), function () {
                                $('input[name=\'payment_method\']:first').attr('checked', 'checked').prop('checked', true).click();
                            });

                        } else {
                            location = json['redirect'];
                        }
                    }
                });
            }
        });
    }

    function voucher_remove(voucher_key) {
        $.ajax({
            url: 'index.php?route=checkout/oct_fastorder/cart&remove=' + voucher_key,
            type: 'get',
            dataType: 'html',
            success: function (data) {
                $.ajax({
                    url: 'index.php?route=checkout/oct_fastorder/status_cart',
                    type: 'get',
                    dataType: 'json',
                    success: function (json) {
                        if (json['total']) {
                            setTimeout(function () {
                                $('#cart .header-buttons-cart-quantity').html(json['total']);
                                // $('.rm-cart-text').html(json['total_amount']);
                            }, 100);
                        }
                        if (!json['redirect']) {
                            $(".shipping-method").load('index.php?route=checkout/oct_fastorder/shipping_method', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, input[name=\'shipping_method\']:first, .oct-checkout textarea, .oct-checkout select'), function () {
                                if ($("input[name=\'shipping_method\']:first").length) {
                                    $("input[name=\'shipping_method\']:first").attr('checked', 'checked').prop('checked', true).click();
                                } else {
                                    $("#cart-table").load('index.php?route=checkout/oct_fastorder/cart', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select'));
                                }
                            });

                        } else {
                            location = json['redirect'];
                        }
                    }
                });
            }
        });
    }


    $(document).on('click', '.shipping-method-box input[type="radio"]', function (e) {
        let deliveryCode = $(e.target).val();
        let deliveryTitle = $(e.target).attr('title');
        console.log(deliveryCode, deliveryTitle)

        let deliveryName = '';
        if(deliveryCode.indexOf('novaposhta') >= 0){
            deliveryName = ' - Нова пошта';
        }else if(deliveryCode.indexOf('free.free') >= 0){
            deliveryName = ' - Укрпошта';
        }


        $('.delivery-method-name').text(deliveryName);

        $('.user_info_adress').attr('data-delivery-code', deliveryCode)

        if (deliveryCode == 'pickup.pickup') {
            setTimeout(function () {
                $('#input-payment-address-1').val(deliveryTitle)
                $('#input-payment-city').val(deliveryTitle)

                $('#input-shipping-address-1').val(deliveryTitle)
                $('#input-shipping-city').val(deliveryTitle)

                $('#input-shipping-firstname').val($('#input-payment-firstname').val());
                $('#input-shipping-lastname').val($('#input-payment-lastname').val());
                $('#input-shipping-zone').val(3491)

                $('.shipping_address_new').click();

            }, 100)
        } else {
            $('#input-payment-address-1').val('')
            $('#input-payment-city').val('')
            $('#input-shipping-address-1').val('')
            $('#input-shipping-city').val('')
            $('#input-shipping-firstname').val('');
            $('#input-shipping-lastname').val();
            $('#input-shipping-zone').val(null)
        }
    });

    /*
    $('.shipping-method-box input[type="radio"]').click(function(e){
        let deliveryCode = $(this).val();
        let deliveryTitle = $(this).attr('title');

        console.log(deliveryCode,deliveryTitle)

        $('.user_info_adress').attr('data-delivery-code', deliveryCode)

        if(deliveryCode == 'pickup.pickup'){
            setTimeout(function (){
                $('#input-payment-address-1').val(deliveryTitle)
                $('#input-payment-city').val(deliveryTitle)
            }, 250)
        }else{
            $('#input-payment-address-1').val('')
            $('#input-payment-city').val('')
        }
    });*/


    $('input[name="city"]').change(function () {
        $('#input-payment-address-1').focus()
    });

    $(document).ready(function(){

        if(('input[name="shipping_method"]:checked').length) {
            let deliveryCode = $('input[name="shipping_method"]:checked').val();

            let deliveryName = '';
            if (deliveryCode.indexOf('novaposhta') >= 0) {
                deliveryName = ' - Нова пошта';
            } else if (deliveryCode.indexOf('free.free') >= 0) {
                deliveryName = ' - Укрпошта';
            }
            $('.delivery-method-name').text(deliveryName);
        }
    });


    // Оновлення методу доставки
    $(".shipping-method").load('index.php?route=checkout/oct_fastorder/shipping_method', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, input[name=\'shipping_method\']:first, .oct-checkout textarea, .oct-checkout select'), function () {
        if ($("input[name=\'shipping_method\']:first").length) {
            $("input[name=\'shipping_method\']:first").attr('checked', 'checked').prop('checked', true).click();
        } else {
            $("#cart-table").load('index.php?route=checkout/oct_fastorder/cart', $('.oct-checkout input[type=\'text\'], .oct-checkout input[type=\'date\'], .oct-checkout input[type=\'datetime-local\'], .oct-checkout input[type=\'time\'], .oct-checkout input[type=\'password\'], .oct-checkout input[type=\'hidden\'], .oct-checkout input[type=\'checkbox\']:checked, .oct-checkout input[type=\'radio\']:checked, .oct-checkout textarea, .oct-checkout select'));
        }
    });

</script>

					<!-- START Shipping Data -->
					<script type="text/javascript"><!--
						/* Autocomplete for shipping addresses */
						(function ($) {
							var methods = {
								init: function (options) {
									return this.each(function () {
										var $this = $(this);
										var data = $this.data('autocompleteAddress');

										/* If the plugin is not yet initialized */
										if (!data) {
											$this.timer = null;
											$this.items = new Array();

											$.extend($this, options);

											$this.attr('autocomplete', 'new-password');

											/* Focus */
											$this.on('focus.autocompleteAddress', function () {
												$this.request('');
											} );

											/* Blur */
											$this.on('blur.autocompleteAddress', function () {
												setTimeout(function (object) {
													object.hide();
												}, 200, $this);
											} );

											/* Keydown */
											$this.on('keydown.autocompleteAddress', function (event) {
												switch (event.keyCode) {
													case 27: // escape
														$this.hide();
														break;
													default:
														$this.request();
														break;
												}
											} );

											/* Click */
											$this.click = function (event) {
												event.preventDefault();

												var id = $(event.target).parent().attr('data-id');
												var value = $(event.target).parent().attr('data-value');

												if (value && $this.items[id]) {
													$this.select($this.items[id]);
												}
											}

											/* Show */
											$this.show = function () {
												var pos = $this.position();

												$this.siblings('ul.' + $this.class).css({
													'top': pos.top + $this.outerHeight(),
													'left': pos.left
												});

												$this.siblings('ul.' + $this.class).show();
											}

											/* Hide */
											$this.hide = function () {
												$this.siblings('ul.' + $this.class).hide();
											}

											/* Request */
											$this.request = function (search) {
												clearTimeout($this.timer);

												$this.timer = setTimeout(function (object) {
													search = (typeof(search) === 'undefined') ? object.val() : search;

													object.source(search, $.proxy(object.response, object));
												}, 200, $this);
											}

											/* Response */
											$this.response = function (json) {
												var html = '';

												if (json.length) {
													for (i = 0; i < json.length; i++) {
														this.items[i] = json[i];

														html += '<li data-id="' + i + '" data-value="' + json[i]['value'] + '"><a href="#">' + json[i]['label'] + '</a></li>';
													}
												}

												if (html && $this.is(':focus')) {
													$this.show();
												} else {
													$this.hide();
												}

												$this.siblings('ul.' + $this.class).html(html);
											}

											$this.after('<ul class="' + $this.class + '"></ul>');
											$this.siblings('ul.' + $this.class).delegate('a', 'click', $.proxy($this.click, $this));
											$this.data('autocompleteAddress', true);
										}
									} );
								},
								destroy: function () {
									return this.each(function () {
										var $this = $(this);

										$this.removeData('autocompleteAddress');

										$this.off('.autocompleteAddress');
									} );
								}
							};

							$.fn.autocompleteAddress = function (method) {
								if (methods[method]) {
									return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
								} else if (typeof (method) === 'object' || !method) {
									return methods.init.apply(this, arguments);
								} else {
									$.error('Method "' + method + '" does not exist for jQuery.autocompleteAddress');
								}
							}
						} )(window.jQuery);

						/* ShippingData object */
						function ShippingData() {
							var self = this;
							var src, method, lang, city;

							self.methods_city = [
								'novaposhta.department',
								'novaposhta.doors',
								'novaposhta.poshtomat',
								'rozetka_delivery.department',
								'ukrposhta.express_department',
								'ukrposhta.standard_department',
								'ukrposhta.express_doors',
								'ukrposhta.standard_doors',
								'justin.department'
							];

							self.methods_department = [
								'novaposhta.department',
								'novaposhta.poshtomat',
								'rozetka_delivery.department',
								'ukrposhta.express_department',
								'ukrposhta.standard_department',
								'justin.department'
							];

							self.methods_address = [
								'novaposhta.doors'
							];

							self.languages = {
								'en': {
									'shipping_method': 'Shipping method',
									'text_select': ' --- Select --- ',
									'novaposhta_department': 'To Nova poshta department',
									'novaposhta_doors': 'To Nova poshta doors',
									'novaposhta_poshtomat': 'To Nova poshta poshtomat',
									'rozetka_delivery_department': 'To ROZETKA Delivery department',
									'ukrposhta_express_department': 'Ukrposhta Express department',
									'ukrposhta_express_doors': 'Ukrposhta Express doors',
									'ukrposhta_standard_department': 'Ukrposhta Standard department',
									'ukrposhta_standard_doors': 'Ukrposhta Standard doors',
									'justin_department': 'To Justin department'
								},
								'uk': {
									'shipping_method': 'Спосіб доставки',
									'text_select': ' --- Оберіть --- ',
									'novaposhta_department': 'У відділення Нової пошти',
									'novaposhta_doors': 'Кур`єром Нової пошти на адресу',
									'novaposhta_poshtomat': 'У поштомат Нової пошти',
									'rozetka_delivery_department': 'У відділення ROZETKA Delivery',
									'ukrposhta_express_department': 'Укрпошта Експрес до відділення',
									'ukrposhta_express_doors': 'Укрпошта Експрес кур`єром',
									'ukrposhta_standard_department': 'Укрпошта Стандарт до відділення',
									'ukrposhta_standard_doors': 'Укрпошта Стандарт кур`єром',
									'justin_department': 'У відділення Justin'
								},
								'ru': {
									'shipping_method': 'Способ доставки',
									'text_select': ' --- Выберите --- ',
									'novaposhta_department': 'В отделение Новой почты',
									'novaposhta_doors': 'Курьером Новой почты по адресу',
									'novaposhta_poshtomat': 'В почтомат Новой почты',
									'rozetka_delivery_department': 'В отделение ROZETKA Delivery',
									'ukrposhta_express_department': 'Укрпочта Експрес до отделения',
									'ukrposhta_express_doors': 'Укрпочта Експрес курьером',
									'ukrposhta_standard_department': 'Укрпочта Стандарт до отделения',
									'ukrposhta_standard_doors': 'Укрпочта Стандарт курьером',
									'justin_department': 'В отделение Justin'
								}
							};

							self.setProp = function () {
								self.method = $('input[name="shipping_method"]:checked').val() || $('select[name="shipping_method"]').val();
								self.lang = $('html').attr('lang') || 'uk';
							}

							self.handlerChanges = function (name, value) {
								if ($.inArray(self.method, self.methods_city.concat(self.methods_department, self.methods_address)) != - 1) {
									if (name.match(/zone/i)) {
										$('input[name*="city"]:visible').val('');
										$('input[name*="address_1"]:visible, input[name*="address_2"]:visible, input[name*="street"]:visible, input[name*="postcode"]:visible').val('');
									} else if (name.match(/city/i)) {
										$('input[name*="address_1"]:visible, input[name*="address_2"]:visible, input[name*="street"]:visible, input[name*="postcode"]:visible').val('');
									} else if (name.match(/shipping\_method/i)) {
										$('input[name*="city"]:visible, input[name*="address_1"]:visible, input[name*="address_2"]:visible, input[name*="street"]:visible, input[name*="postcode"]:visible').val('').autocompleteAddress('destroy');

										self.method = value;
									}
								} else if ($.inArray(value, self.methods_city.concat(self.methods_department, self.methods_address)) != - 1) {
									if (name.match(/shipping\_method/i)) {
										$('input[name*="address_1"]:visible, input[name*="address_2"]:visible, input[name*="street"]:visible').val('');

										self.method = value;
									}
								}
							}

							self.getAddress = function (element, search) {
								var filter, action;

								if (element[0].name.match(/city/i)) {
									action = 'getCities';
									filter = $('[name*="zone"]:visible').val() || '';
								} else if (element[0].name.match(/address_1/i)) {
									action = 'getDepartments';
									filter = $('[name*="city"]:visible').val();
								} else if (element[0].name.match(/address_2|street/i)) {
									action = 'getStreets';
									filter = self.city || $('[name*="city"]:visible').val();
								} else if (element[0].name.match(/postcode/i)) {
									action = 'getPostCodes';
									filter = '';
								}

								if (!search) {
									search = element[0].value;
								}

								return $.ajax( {
									url: 'index.php?route=extension/module/shippingdata/getShippingData',
									type: 'POST',
									data: 'shipping=' + self.method + '&action=' + action + '&filter=' + encodeURIComponent(filter) + '&search=' + encodeURIComponent(search),
									dataType: 'json',
									global: false,
									success: function (json) {
										self.src = json;
									}
								} );
							}
						}

						/* DOOM loaded */
						$(function () {
							var shippingData = new ShippingData();

							/* Settings properties after DOOM load */
							shippingData.setProp();

							/* Settings properties after ajaxStop */
							$(document).ajaxStop(function () {
								shippingData.setProp();
							});

							/* Fix default checkout */
							$(document).ajaxSuccess( function(ev, xhr, settings) {
								if (settings.url.indexOf('register') > -1 || settings.url.indexOf('guest') > -1 || settings.url.indexOf('payment_address') > -1) {
									$('div.form-group > label[for*="company"]').before('<div class="form-group"><label class="control-label" for="input-shipping_method">' + shippingData.languages[shippingData.lang].shipping_method + '</label><select name="shipping_method" id="input-shipping_method" class="form-control"><option value="">' + shippingData.languages[shippingData.lang].text_select + '</option><option value="novaposhta.department">' + shippingData.languages[shippingData.lang].novaposhta_department + '</option><option value="novaposhta.doors">' + shippingData.languages[shippingData.lang].novaposhta_doors + '</option><option value="novaposhta.poshtomat">' + shippingData.languages[shippingData.lang].novaposhta_poshtomat + '</option><option value="rozetka_delivery.department">' + shippingData.languages[shippingData.lang].rozetka_delivery_department + '</option><option value="ukrposhta.express_department">' + shippingData.languages[shippingData.lang].ukrposhta_express_department + '</option><option value="ukrposhta.express_department">' + shippingData.languages[shippingData.lang].ukrposhta_express_doors + '</option><option value="ukrposhta.standard_department">' + shippingData.languages[shippingData.lang].ukrposhta_standard_department + '</option><option value="ukrposhta.standard_department">' + shippingData.languages[shippingData.lang].ukrposhta_standard_doors + '</option></select></div>');
								}
							});

							/* Check changes */
							$(document).on('change', '[name*="zone"]:visible, [name*="city"]:visible, [name*="shipping_method"]', function (e) {
								shippingData.handlerChanges(e.target.name, e.target.value);
							});

							/* Add autocomplete for city */
							$('body').on('focus', 'input[name*="city"]:visible', function () {
								if (this.name.match(/city/i) && $.inArray(shippingData.method, shippingData.methods_city) != - 1) {
									$(this).autocompleteAddress({
										source: function (request, response) {
											shippingData.getAddress(this, request).done(function () {
												response($.map(shippingData.src, function (item) {
													return {
														id:    item['id'] || '',
														label: item['full_description'] || item['description'],
														value: item['description']
													}
												}));
											});
										},
										select: function (e) {
											if (e.value != this.val()) {
												this.val(e.value);
												shippingData.city = e.id;

												this.trigger('change');
											}
										},
										class: 'dropdown-address'
									});
								}
							});

							/* Add autocomplete for department */
							$('body').on('focus', 'input[name*="address_1"]:visible', function () {
								if (this.name.match(/address_1/i) && $.inArray(shippingData.method, shippingData.methods_department) != - 1) {
									$(this).autocompleteAddress({
										source: function (request, response) {
											shippingData.getAddress(this, request).done(function () {
												response($.map(shippingData.src, function (item) {
													return {
														label: item['full_description'] || item['description'],
														value: item['description'],
														postcode: item['postcode'] || ''
													}
												}));
											});
										},
										select: function (e) {
											if (e.value != this.val()) {
												if (e.postcode) {
													$('input[name*="postcode"]:visible').val(e.postcode);
												}

												this.val(e.value);

												this.trigger('change');
											}
										},
										class: 'dropdown-address'
									});
								}
							});

							/* Add autocomplete for address */
							$('body').on('focus', 'input[name*="address_2"]:visible, input[name*="street"]:visible', function () {
								if (this.name.match(/address_2|street/i) && $.inArray(shippingData.method, shippingData.methods_address) != - 1) {
									$(this).autocompleteAddress({
										source: function (request, response) {
											shippingData.getAddress(this, request).done(function () {
												response($.map(shippingData.src, function (item) {
													return {
														label: item['full_description'] || item['description'],
														value: item['description']
													}
												}));
											});
										},
										select: function (e) {
											if (e.value != this.val()) {
												this.val(e.value);

												this.trigger('change');
											}
										},
										class: 'dropdown-address'
									});
								}
							});

							/* Add autocomplete for postcode */
							$('body').on('focus', 'input[name*="postcode"]:visible', function () {
								if (this.name.match(/postcode/i) && $.inArray(shippingData.method, shippingData.methods_city) != - 1) {
									$(this).autocompleteAddress({
										source: function (request, response) {
											shippingData.getAddress(this, request).done(function () {
												response($.map(shippingData.src, function (item) {
													return {
														label: item['full_description'] || item['description'],
														value: item['description'],
														city: item['city'] || '',
														department: item['department'] || ''
													}
												}));
											});
										},
										select: function (e) {
											if (e.value != this.val()) {
												if (e.city) {
													$('input[name*="city"]:visible').val(e.city);
												}

												if (e.department) {
													$('input[name*="address_1"]:visible').val(e.department);
												}

												this.val(e.value);

												this.trigger('change');
											}
										},
										class: 'dropdown-address'
									});
								}
							});
						});
					//--></script>
					<!-- END Shipping Data -->
        		
{{ footer }}